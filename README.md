![Tenable+Nessus+banner](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/3e101623-1516-43d0-9d93-a2acdbe09379)

# Vulnerability Management
### Learning objectives:
1. Provisioning and deprovisioning virtual environments within VMware.
2. Run initial vulnerability scan using Nessus against vm and observe results.
3. Run a credentialed vulnerability scan and compare/contrast results.
4. Remediation

### Technologies and Protocols:
* VMware Workstation 16 Player
* Nessus Essentials 
* Windows ISO + Firefox 3.6.12

> NOTE: This lab will be done on a Windows machine.
 
### Overview:
<img width="961" alt="nessus_overview" src="https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/84610b0e-c1bb-4fc4-ae31-d99c73a0ae03">


## Step 1.1: Signup and install [Nessus Essentials](https://www.tenable.com/products/nessus/nessus-essentials)
- Register for an account
- You will receive an activation code in your email
- Copy your activation code in your email and click the Download Nessus as well
- Choose Nessus > View Downloads 
- Under version chose Nessus - 8.15.6
- Under platform choose Windows - x86_64 **make sure it includes Server 2012 R2, 7,8,10**
- Open Tenable Nessus and click next and install
- After finishing installation and window should pop up with a local host URL 
- Copy/paste the URL for future use 

![S1 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/631aed6a-22ef-4833-a7fa-b1bd28f3f209)

## Step 1.2: Finish Nessus installation 
- click Connect via SSL on web page 
- Click Advance on warning page > continue to localhost > Nessus Essentials 
- Click skip on Get an activation code (we already have ours)
- Paste activation code > continue 
- Create a username and password **remember for future use**
- Click submit > and wait for download 
- Let’s download the rest of our tools while we wait

![S1 2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/7c60f638-ded9-4648-ac36-2c6c4ef41c77)

## Step 2: Download [Windows 10 ISO file](https://www.microsoft.com/en-us/software-download/windows10)
- click download now and open file 
- Accept license terms and chose Choose Create installation …
- finish setup and chose ISO file 
- Wait for download and click finish

![S2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/104f427d-6c4b-4148-aec1-31ba1a018825)


## Step 3: Download [VMware Workstaion 16 Player](https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html)

## Step 4: Setup virtual machine
- open up VMware workstation 
- Click Player > file > new virtual machine 
- For the Installer disc image file (ISO) browse and select your windows 10 ISO. 
- Hit next > next > maximum disk size is fine > customize hardware
- Under customize hardware > select 4 GB of RAM 
- Under Network adapter choose *Bridged*
- Click close and finish 
- Open your vm and follow the steps to install Windows 
- **remember your user name and password** when you create an account 

![S4 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/79863806-9ce6-4751-aa13-a4cbbc2c79b2)

## Step 5.1: Configure vm
- let’s scan our vm to see if you get any response - later we’ll do a more powerful credential scan 
- Go to your vm and search CMD to open the command line > use `ipconfig` to get your ipv4 address.


![S5 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/267c4656-1b39-4674-85d7-d22b629c0760)

## Step 5.2: Configure vm (cont.)
- in your vm search mf.msc > windows defender firewall properties 
- Under Domain profile tab, private profile tab and public profile tab turn the firewalls OFF.

![S5 2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/9ea74097-034e-419e-a46b-562cc1e65147)


## Step 5.3: check for connectivity 
- in your *host* machine ping your vm - with firewalls off this should work!

## Step 6: Basic Nessus Scan
- sign into Nessus Essentials and click Create a new scan 
- Under vulnerabilities choose Basic Network Scan
- Name it Windows 10 Single Host and paste the *vm* ip in the targets field. 
- Leave the rest of the setting alone 
- Hit save, you should see the scan we just configured on the next page 
- Scroll over and hit the play button …
- Give it a second to scan 

![S6 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/f065e9af-5666-4bbf-985a-f8e1fbf4c86d)

## Step 7: Basic scan results 
- If you click on the scan we can look at the details of the results. 
- Not much information is brought back but still some interesting fields.


![S7 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/1d18b673-cf49-4274-a64a-1015c5389e83)


- If we click vulnerabilities tab we see 1 medium sever vulnerability. 
- Most look like to be basic info vulnerabilities - just Nessus giving us a heads up. 


![S7 2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/b156cbe9-a262-4d60-8f98-ca4786348e24)



- when we click on the medium severity we find “SMB Signing not required”. 
- There’s a description and solution as well. Neat. 
- Next let’s configure our vm for a stronger, credentialed scan

![S7 3](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/4338a84d-02d5-46e1-915e-7f296b4519d1)

## Step 8.1: Configuring vm to allow a credentialed scan
- On your vm, search services. 
- Find and click Remote Registry > under Startup type choose Automatic > click Apply > start
- This will allow Nessus to **crawl** through our vm registry and allow a scan. 

![S8 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/591ba424-e731-4602-a735-5822db7d943f)

## Step 8.2: Change User Account Control Settings
- Search user account control 
- Change the setting to Never Notify 

![S8 2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/93733655-f77a-47cf-a127-6f65bcff802a)


> NOTE: these setting are not recommended in any other context. These are just for demo and lab purposes. 

## Step 8.3: Add a Registar key to further connectivity into the Registry. 
- search Registry Editor 
- Choose LOCAL_MACHINE > SOFTWARE > Microsoft > Windows > Current version > Policies > System 
- Under system right-click and crest a new DWORD Value
- Name it `LocalAccountTokenFilterPolicy`
- Double-click it and set the value to 1 
- Restart your vm

![S8 3](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/1fc34381-325b-4ed4-b6ed-cf76f208c472)


## Step 9.1: Configure a credential scan on Nessus 
- back on Nessus, select our original scan and click more at the top > configure 
- Under the Credentials tab > windows 
- Make sure Password is selected and put your username and password from the vm here. 
- Go back to My Scans and hit play button to run …

![S9 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/723947df-f202-4cd5-adba-02702c94328d)


## Step 9.2: NEW credentialed scanned 
- after clicking our NEW scan you can already notice a significant difference!
- Our basic scan returned to us 1 medium vulnerability, but our credentialed scanned returned 2 critical, 9 high, 19 medium and 1 low vulnerability. Wow!
- If you click into the History tab you can compare the pie chart of our two scans.

![S9 2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/d3678bd4-e3d1-4936-b3ed-49009c7233a5)

> this highlights the importance of running a credentialed scan

## Step 9.3: Potential quick Remediations 
- if we take a look at the Remediations tab we find two actions Nessus recommends to take. 
- These are high level recommendations that would remediate most of our specific vulnerabilities. 
- So instead of running a fine-tooth comb we can potentially take these 2 actions to cover most vulnerabilities - and it looks like a couple of quick updates/patching would do the trick. 
- Something to think about for those vulnerability managers in the future.  

![S9 3](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/061ed92b-6830-4733-95b5-922eff980e93)


> patching / updating these systems would fix a lot of our vulnerabilities. 

## Step 10: Let’s add some depreciated software to SPICE up another scan
- We can download an old version of Firefox [here](https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/)
- NOTE: download this onto your vm
- Download the first 3.6.12.exe file you see. 
- Install Firefox 3.6.12 (2015 version) on your vm as seen here:

![S10](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/5277004f-dacb-4fc5-a25e-389a72bda438)

## Step 11: Launch another scan 
- Back on our Nessus go to My Scans > and launch the same scan - this time we don’t need to make any new reconfigurations. 
- Give it some time …

![S11](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/fde63c5c-f112-42fc-8e73-b05a57a7b206)

## Step 12: Scan results after installing depreciated Firefox 
- Let’s compare our three scans now. 
- First our default out-of-the-box scan:

![S12 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/e7c87767-dc4d-4ac0-9bbe-7b34fcc0185e)

- Next our more robust, credentialed scan:

![S12 2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/e4fbbed8-1be5-4d6c-a48f-e114de905c06)

- And finally, our credentialed scanned with an old version of Firefox:

![S12 3](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/f7f9a950-5280-4963-b5a4-05cb8ecff8ce)

> what a world of difference! - our initial credentialed scan returned 1% critical vulnerabilities, but our scan with the OLD Firefox returned 13% in critical vulnerabilities. 


![S12 4](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/7b91850e-d676-4802-8d37-8f579b0cd05c)

KEY TAKE AWAY: with the inclusion of depreciated software we saw a 13x jump in critical vulnerabilities. An easy fix to these vulnerabilities would be to simply uninstall the software. Again, this is why it is so important to keep your software and systems patched and updated in the real world. 

## Step 13: System Remediations through updates and patching
- Back on our vm - search and run `appwiz.cpl`
- Choose Firefox 3.6.12 and click uninstall 
- Go back to search > windows update > and check for updates 
- Click Install now for any updates …
- After installing updates and restarting your vm, check again for updates. 
- After installing any new updates, restart and we should be good!

![S13](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/0d675bf4-614d-4c57-aed4-b3976b9d13ef)

## Step 14: Run final scan and compare 
- Back on Nessus, run our scan one final time. 
- We should see a bunch of remediations after the scan is complete. 
- Let’s compare our initial credential scan to our most recent scan in the history tab - these two are the most consistent. 
- Our initial, default credential scan:


![S14 1](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/d185f88f-d8cd-4e92-ada4-994996407716)


> This scan returned to us 6% high and 14% medium vulnerabilities. 

- Our remediated credential scan: 

![S14 2](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/4fd10459-7509-432c-9b52-fe0d5ab93e45)


> In comparison, our final scan returned only 2% high and 10% medium vulnerabilities. 

- Simply updating Windows remediated more than half of our high vulnerabilities.

## Final Step: Further Possible remediations
- take a look at the Vulnerabilities tab 
- Internet explorer still has some high/mixed vulnerabilities. 
- What else can we do to take care of these vulnerabilities? Possibly more updates …

![S15](https://github.com/JAcobCovarrubias/Vulnerability-Management-with-Nessus-Essentials/assets/137449348/b0c3729c-c3cd-4bc0-b0ae-97157eb19a4a)












